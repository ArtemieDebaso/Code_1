{% extends "layout.html" %}

{% block title %}Резервное копирование{% endblock %}

{% block content %}
<div class="row">
    <!-- Боковое меню -->
    <div class="col-md-3 sidebar">
        <h4 class="mb-3">Панель администратора</h4>
        <div class="nav flex-column nav-pills">
            <a class="nav-link" href="/admin/dashboard">
                <i class="bi bi-speedometer2 me-2"></i>Обзор
            </a>
            <a class="nav-link" href="/admin/users">
                <i class="bi bi-people me-2"></i>Управление пользователями
            </a>
            <a class="nav-link" href="/admin/groups">
                <i class="bi bi-collection me-2"></i>Управление группами
            </a>
            <a class="nav-link" href="/admin/tests">
                <i class="bi bi-journal-text me-2"></i>Управление тестами
            </a>
            <a class="nav-link active" href="/admin/backup">
                <i class="bi bi-cloud-arrow-down me-2"></i>Резервное копирование
            </a>
        </div>
    </div>
    
    <!-- Основной контент -->
    <div class="col-md-9">
        <div class="page-title d-flex justify-content-between align-items-center">
            <h2><i class="bi bi-cloud-arrow-down me-2"></i>Резервное копирование</h2>
            <div>
                <a href="/admin/backup/download" class="btn btn-success">
                    <i class="bi bi-cloud-download me-2"></i>Создать резервную копию
                </a>
            </div>
        </div>
        
        <!-- Карточка с информацией -->
        <div class="card mb-4">
            <div class="card-header bg-light">
                <h5 class="mb-0"><i class="bi bi-info-circle me-2"></i>Информация о резервных копиях</h5>
            </div>
            <div class="card-body">
                <div class="alert alert-info">
                    <i class="bi bi-info-circle-fill me-2"></i>Резервное копирование позволяет сохранить данные системы и восстановить их в случае необходимости.
                </div>
                
                <table class="table">
                    <tbody>
                        <tr>
                            <th style="width: 40%;">Последнее резервное копирование</th>
                            <td>{{ backup_data.backup_time }}</td>
                        </tr>
                        <tr>
                            <th>Пользователи в базе</th>
                            <td>{{ backup_data.users|length }}</td>
                        </tr>
                        <tr>
                            <th>Тесты в базе</th>
                            <td>{{ backup_data.tests|length }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- JSON представление -->
        <div class="card">
            <div class="card-header bg-light">
                <h5 class="mb-0"><i class="bi bi-code-slash me-2"></i>Данные для резервного копирования</h5>
            </div>
            <div class="card-body">
                <div class="alert alert-warning">
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>Внимание! Ниже представлено содержимое базы данных в формате JSON. Не передавайте эти данные третьим лицам.
                </div>
                
                <div class="bg-light p-3 rounded">
                    <pre class="mb-0" style="max-height: 500px; overflow-y: auto;">{{ backup_data }}</pre>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
